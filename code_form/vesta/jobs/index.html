<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-code_form/vesta/jobs">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Lancer un calcul | Documentation de MesoNET</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-test-site.com/documentation/user-documentation/img/logomeso.png"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-test-site.com/documentation/user-documentation/img/logomeso.png"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/documentation/user-documentation/code_form/vesta/jobs"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lancer un calcul | Documentation de MesoNET"><meta data-rh="true" name="description" content="Le principe d&#x27;un gestionnaire de ressources est de vous réserver des cœurs de calcul en fonction de vos besoins. SLURM est le gestionnaire installée sur Vesta."><meta data-rh="true" property="og:description" content="Le principe d&#x27;un gestionnaire de ressources est de vous réserver des cœurs de calcul en fonction de vos besoins. SLURM est le gestionnaire installée sur Vesta."><link data-rh="true" rel="icon" href="/documentation/user-documentation/img/faviconM.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/documentation/user-documentation/code_form/vesta/jobs"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/documentation/user-documentation/code_form/vesta/jobs" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/documentation/user-documentation/code_form/vesta/jobs" hreflang="x-default"><link rel="stylesheet" href="/documentation/user-documentation/assets/css/styles.89ad5c2c.css">
<link rel="preload" href="/documentation/user-documentation/assets/js/runtime~main.cef61de5.js" as="script">
<link rel="preload" href="/documentation/user-documentation/assets/js/main.f30abc10.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/user-documentation/"><div class="navbar__logo"><img src="/documentation/user-documentation/img/logomeso.png" alt="MesoNet Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/documentation/user-documentation/img/logomeso.png" alt="MesoNet Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/documentation/user-documentation/">Documentation</a><a href="https://acces.mesonet.fr/gramc-meso/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Portail</a><a href="https://mesonet.fr" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Site web</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/documentation/user-documentation/">Accueil</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/documentation/user-documentation/category/le-portail-mesonet">Le portail MesoNET</a><button aria-label="Toggle the collapsible sidebar category &#x27;Le portail MesoNET&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/documentation/user-documentation/category/machine-codeformation">Machine Code/Formation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Machine Code/Formation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/documentation/user-documentation/code_form/juliet/">Juliet, machine IA/GPU</a><button aria-label="Toggle the collapsible sidebar category &#x27;Juliet, machine IA/GPU&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/documentation/user-documentation/code_form/vesta/description">Vesta</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/user-documentation/code_form/vesta/description">Description</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/user-documentation/code_form/vesta/connexion">Se connecter à Vesta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/documentation/user-documentation/code_form/vesta/jobs">Lancer un calcul</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/user-documentation/code_form/vesta/module">Environnements logiciels</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/user-documentation/code_form/vesta/cgu">CGU</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/documentation/user-documentation/code_form/zen/">Zen</a><button aria-label="Toggle the collapsible sidebar category &#x27;Zen&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/documentation/user-documentation/code_form/phileas/">Phileas</a><button aria-label="Toggle the collapsible sidebar category &#x27;Phileas&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/documentation/user-documentation/category/architectures-de-prototypage-et-spécialisées">Architectures de Prototypage et Spécialisées</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architectures de Prototypage et Spécialisées&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/documentation/user-documentation/category/tutoriaux">Tutoriaux</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutoriaux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/documentation/user-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/documentation/user-documentation/category/machine-codeformation"><span itemprop="name">Machine Code/Formation</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Vesta</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lancer un calcul</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Prise en main rapide de SLURM</h1><p>Le principe d&#x27;un gestionnaire de ressources est de vous réserver des cœurs de calcul en fonction de vos besoins. <strong>SLURM</strong> est le gestionnaire installée sur <strong>Vesta</strong>.</p><p>Vous interagissez avec le gestionnaire de ressources par les commandes suivantes :</p><ul><li><strong>sbatch</strong> : soumission d&#x27;un job dans une file d&#x27;attente (appelées partitions dans Slurm) ;</li><li><strong>scancel</strong> : suppression d&#x27;un job ;</li><li><strong>squeue</strong> : interrogation des jobs ;</li><li><strong>scontrol</strong> : interrogation détaillée d&#x27;un job ou d&#x27;une partition ;</li><li><strong>sinfo</strong> : interrogation des files d&#x27;attente ;</li><li><strong>srun</strong> : exécution immédiate d&#x27;une commande ;</li><li><strong>salloc</strong> : batch interactif, obtention d&#x27;un shell, permettant d&#x27;enchaîner plusieurs commandes sur les mêmes ressources ;</li><li><strong>sprio</strong> : priorités relatives entre les jobs en attente.</li></ul><p>Une documentation des commandes de base est disponible ici : <a href="http://slurm.schedmd.com/man_index.html" target="_blank" rel="noopener noreferrer">http://slurm.schedmd.com/man_index.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="les-partitions">Les partitions<a href="#les-partitions" class="hash-link" aria-label="Direct link to Les partitions" title="Direct link to Les partitions">​</a></h2><p>Les différents nœuds de calcul sont regroupés en fonction de différents critères dans des partitions.<br>
<!-- -->Lors de la soumission d&#x27;un job, il faut choisir une partition.<br>
<!-- -->Le cluster Vesta ne possède pour le moment qu&#x27;une parition nommé <strong>mesonet</strong> qui sera utilisée par défaut pour tous les jobs. Cette parition possède une limite de temps de <strong>24 heures</strong> par job. Cette limite est amenée à évoluer au cours du temps.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lancement-dun-job">Lancement d&#x27;un job<a href="#lancement-dun-job" class="hash-link" aria-label="Direct link to Lancement d&#x27;un job" title="Direct link to Lancement d&#x27;un job">​</a></h2><p>Pour lancer un job, il faut créer un script dans lequel il faut demander des ressources puis appeler son programme (voir les exemples plus loin).</p><p>Ce script est ensuite soumi au gestionnaire de file d&#x27;attente avec la commande <strong>sbatch</strong>. Par exemple :</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sbatch mon_script</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On obtient alors un numéro de job, qui peut être manipulé avec les commandes scancel, squeue ou scontrol.</p><p>Le script peut être écrit dans le langage de son choix (bash, zsh, tcsh, python, perl...). Il peut être exécuté directement, sans être appelé par sbatch, et dans ce cas, les directives d&#x27;allocations de ressources seront ignorées, et il s&#x27;exécutera dans le shell local.</p><p>Par défaut, la sortie standard du job (ce qui doit normalement s&#x27;afficher sur l&#x27;écran lorsque vous exécutez votre programme) sera écrit dans le fichier <strong>slurm-jobid.out</strong>, avec jobid égal au numéro de job.</p><p>Voici un exemple d&#x27;un script de soumission demandant 2 nœuds de calcul avec chacun 10 GPUs :</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#! /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH -A account      # Cet account vous sera fourni à la création de votre projet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH -N 2-2          # 2 nœud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH --gres=gpu:10   # 10 GPU par nœud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./mon_code_gpu</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Pour aller plus loin</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="demande-de-ressources">Demande de ressources<a href="#demande-de-ressources" class="hash-link" aria-label="Direct link to Demande de ressources" title="Direct link to Demande de ressources">​</a></h2><p>Vos besoins en terme de ressources sont décrits dans l&#x27;en-tête d&#x27;un fichier via des directives Slurm. Par exemple :</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH -N 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>demandera une allocation de 2 nœuds.</p><p>D&#x27;autres critères peuvent être spécifié via ces directives, comme la taille mémoire souhaitée ou la durée pendant laquelle les ressources seront attribuées.</p><p>En règle générale, plus on sera <strong>parcimonieux dans la demande d&#x27;allocation</strong>, plus on aura de chance de voir rapidement son job passer de l&#x27;état en attente à l&#x27;état en exécution.</p><p>Par exemple, s&#x27;il est possible d&#x27;estimer précisément la durée nécessaire à une exécution, il peut être profitable de réduire au minimum la durée demandée pour la réservation. Ainsi une exécution se faisant en 3h30 pourra se faire au sein d&#x27;un job demandant 4h00 (marge de 30mn par précaution), avec la directive suivante :</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH -t 04:00:00</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Attention toutefois à prendre une marge suffisante, car au-delà du temps demandé, l&#x27;exécution est stoppée automatiquement par Slurm.</p><p>Attention : toutes les partitions sont configurées avec une limite de temps d&#x27;exécution par défaut, qui s&#x27;applique à tout job ne précisant pas combien de temps doit lui être alloué. Pour connaître cette limite, utiliser la commande suivante :</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sinfo -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Remarque : tous les arguments de la directive #SBATCH peuvent également être utilisés en arguments des commandes srun, salloc et sbatch. Voir les exemples plus loin.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quelques-directives-utiles">Quelques directives utiles<a href="#quelques-directives-utiles" class="hash-link" aria-label="Direct link to Quelques directives utiles" title="Direct link to Quelques directives utiles">​</a></h2><ul><li><strong>-A</strong> : compte Slurm à utiliser (il vous est fourni pour chaque projet)</li><li><strong>-N</strong> : nombre de nœuds (min - max)</li><li><strong>-n</strong> : nombre de tâches (1 par nœud par défaut)</li><li><strong>--cpus-per-task</strong> : nombre de cœurs par tâche</li><li><strong>--tasks-per-node=</strong> : nombre de tâches par nœud</li><li><strong>-t J-HH:MM:SS</strong> : temps alloué du job, avant qu&#x27;il ne soit stoppé (par défaut, celui de la partition; voir sinfo -l)</li><li><strong>--gres=gpu:N</strong> : nombre de GPU par nœud (N de 1 à 10)</li><li><strong>--mail-type=END</strong> : envoyer un mail à la fin du job (BEGIN pour en recevoir un au lancement. ALL pour en recevoir un à chaque étape)</li><li><strong>--mail-user=mon@adresse</strong> : adresse mail à utiliser</li><li><strong>--mem=0000M</strong> : mémoire par nœud en Mo (pour le dire en Go, remplacer M par G)</li><li><strong>-o fichier_sortie</strong> : le fichier de sortie du job</li></ul><p>Vous trouverez une liste exhaustive sur le site de Slurm : <a href="https://slurm.schedmd.com/sbatch.html" target="_blank" rel="noopener noreferrer">https://slurm.schedmd.com/sbatch.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suivre-létat-dun-job">Suivre l&#x27;état d&#x27;un job<a href="#suivre-létat-dun-job" class="hash-link" aria-label="Direct link to Suivre l&#x27;état d&#x27;un job" title="Direct link to Suivre l&#x27;état d&#x27;un job">​</a></h2><p>Il est possible d&#x27;obtenir le détail de l&#x27;état d&#x27;un job, qu&#x27;il soit en attente ou en exécution, avec les commandes <strong>scontrol</strong> ou <strong>squeue</strong>.</p><p><strong>Liste de tous les jobs en cours :</strong></p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">squeue</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Liste des jobs en cours d&#x27;un compte particulier :</strong></p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">squeue -u &lt;login&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Détail de l&#x27;état d&#x27;un job :</strong></p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scontrol show job &lt;jobid&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Mon job est en attente. Quand va-t-il démarrer ?</strong></p><p>Pour les jobs en attente, Slurm calcul périodiquement un temps probable de démarrage.<br>
<!-- -->2 possibilités pour l&#x27;obtenir:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scontrol show job &lt;jobid&gt; | grep StartTime=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">squeue -o &quot;%S&quot; -j &lt;jobid&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="autorisations--account">Autorisations / Account<a href="#autorisations--account" class="hash-link" aria-label="Direct link to Autorisations / Account" title="Direct link to Autorisations / Account">​</a></h2><p>Pour utiliser une partition, il faut disposer d&#x27;un compte Slurm (indépendant du login Unix). Ce compte Slurm est configuré notamment en fonction du <strong>quota d&#x27;heures</strong> attribué dans le cadre d&#x27;un projet MESONET.</p><p>Pour utiliser la partition associée aux projets, vous aurez accès à un compte Slurm spécifique, configuré avec un quota d&#x27;heures suite à une allocation du comité scientifique :</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH -p mesonet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#SBATCH -A projet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suivre-sa-consommation">Suivre sa consommation<a href="#suivre-sa-consommation" class="hash-link" aria-label="Direct link to Suivre sa consommation" title="Direct link to Suivre sa consommation">​</a></h2><p>Vous pouvez avoir une indication de votre consommation en heures CPU par la commande</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sreport cluster AccountUtilizationByUser  start=2025-04-01 accounts=votre_account -t hours</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notez que <strong>votre_account</strong> correspond au nom du groupe Unix auquel vous appartenez ou alors au numéro du projet mesonet auquel vous êtes intégrés.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="espace-disque-temporaire">Espace disque temporaire<a href="#espace-disque-temporaire" class="hash-link" aria-label="Direct link to Espace disque temporaire" title="Direct link to Espace disque temporaire">​</a></h2><p>À la soumission d’un job et sur le disque dur de chacun des nœuds qui vous sont alloués, Slurm crée un répertoire <strong>/tmp</strong> utilisable par vos jobs et supprimer dès la fin de ces derniers sans que vous ayez à faire quoi que ce soit. Vous avez avez également accès à un répertoire <strong>/workdir</strong> dans lequel vous pouvez mettre vos fichiers d&#x27;entrée/sortie afin que ces derniers soient présents sur un disque local au nœud, et nom accessible via le réseau. N&#x27;oubliez pas de récupérer les données de sortie si vous utilisez cet espace temporaire qui est détruit à la fin du job.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="variables-denvironnement">Variables d&#x27;environnement<a href="#variables-denvironnement" class="hash-link" aria-label="Direct link to Variables d&#x27;environnement" title="Direct link to Variables d&#x27;environnement">​</a></h2><p>Dans certains cas, votre programme a besoin de connaître plus précisément les ressources que Slurm a mis à sa disposition. Pour cela, Slurm fourni un certain nombre de variables d&#x27;environnement, qui sont utilisables dans le script qui appelle le programme. En voici une liste non exhaustive :</p><ul><li><strong>SLURM_NPROCS</strong> : nombre de cœurs alloués ;</li><li><strong>SLURM_NNODES</strong> : nombre de nœuds alloués ;</li><li><strong>SLURM_CPUS_ON_NODE</strong> : nombre de cœurs alloués par nœud ;</li><li><strong>SLURM_JOB_ID</strong> : job id ;</li><li><strong>SLURM_JOB_NODELIST</strong> : liste des nœuds alloués, sous une forme synthétique. Pour obtenir une liste détaillée, on peut utiliser la commande &quot;<strong>scontrol show hostname</strong>&quot;.</li></ul><p>Liste détaillée : vor chapitre &quot;OUTPUT ENVIRONMENT VARIABLES&quot; sous <a href="https://slurm.schedmd.com/sbatch.html" target="_blank" rel="noopener noreferrer">https://slurm.schedmd.com/sbatch.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="priorités">Priorités<a href="#priorités" class="hash-link" aria-label="Direct link to Priorités" title="Direct link to Priorités">​</a></h2><p>Quand plusieurs jobs sont en même temps en attente dans une file, Slurm calcule une priorité entre ces jobs. Le job ayant la priorité la plus élevée sera le prochain à passer en exécution.</p><p>La priorité des jobs peut être vue avec la commande :</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sprio -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>La priorité dépend de plusieurs facteurs :</p><ul><li>le temps d&#x27;attente déjà écoulé (AGE) ;</li><li>la taille du job en nombre de cœurs : les gros jobs sont favorisés (JOBSIZE) ;</li><li>la consommation en heures cpu sur le passé récent : plus la consommation a été faible, plus la priorité augmentera (FAIRSHARE).</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/documentation/user-documentation/code_form/vesta/connexion"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Se connecter à Vesta</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/documentation/user-documentation/code_form/vesta/module"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Environnements logiciels</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#les-partitions" class="table-of-contents__link toc-highlight">Les partitions</a></li><li><a href="#lancement-dun-job" class="table-of-contents__link toc-highlight">Lancement d&#39;un job</a></li><li><a href="#demande-de-ressources" class="table-of-contents__link toc-highlight">Demande de ressources</a></li><li><a href="#quelques-directives-utiles" class="table-of-contents__link toc-highlight">Quelques directives utiles</a></li><li><a href="#suivre-létat-dun-job" class="table-of-contents__link toc-highlight">Suivre l&#39;état d&#39;un job</a></li><li><a href="#autorisations--account" class="table-of-contents__link toc-highlight">Autorisations / Account</a></li><li><a href="#suivre-sa-consommation" class="table-of-contents__link toc-highlight">Suivre sa consommation</a></li><li><a href="#espace-disque-temporaire" class="table-of-contents__link toc-highlight">Espace disque temporaire</a></li><li><a href="#variables-denvironnement" class="table-of-contents__link toc-highlight">Variables d&#39;environnement</a></li><li><a href="#priorités" class="table-of-contents__link toc-highlight">Priorités</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright 2025 Mesonet</div></div></div></footer></div>
<script src="/documentation/user-documentation/assets/js/runtime~main.cef61de5.js"></script>
<script src="/documentation/user-documentation/assets/js/main.f30abc10.js"></script>
</body>
</html>